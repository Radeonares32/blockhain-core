# Bölüm 3.6: Optimistic QC ve PQ Attestation

Bu bölüm, Budlum projesinin kuantum bilgisayarlara karşı gelecekteki hazırlığı olan **Optimistic QC** ve **Post-Quantum (PQ) Attestation** mekanizmasını detaylandırır.

Kaynak Dosya: `src/consensus/qc.rs`

---

## 1. Kavram: Neden "Optimistic"?

Kuantum sonrası kriptografi (Dilithium vb.), klasik Ed25519 imzalarından çok daha ağır ve büyüktür. Eğer her blokta 100 kişinin PQ imzasını doğrudan ana zincirde doğrulasaydık, ağ performansı ciddi oranda düşerdi.

Budlum bu sorunu **Optimistic (İyimser)** bir yaklaşımla çözer:
- Ağ, tüm PQ imzalarının doğru olduğunu *varsayar*.
- Bu imzalar ana blok başlığına değil, yan kanal olan `QcBlob` içine gömülür.
- Sadece birisi "şu PQ imzasında hata var" diyerek kanıt sunarsa doğrulama yapılır.

---

## 2. Veri Yapısı: `QcBlob`

`QcBlob`, bir blok (checkpoint) için toplanan tüm PQ imzalarını barındıran veri paketidir.

```rust
pub struct QcBlob {
    pub epoch: u64,
    pub checkpoint_height: u64,
    pub checkpoint_hash: String,
    pub signatures: Vec<PqSignatureEntry>, // Dilithium İmzaları
    pub merkle_root: String,               // İmzaların Merkle Ağacı özeti
}
```

- **P2P Akışı:** Düğümler FinalityCert aldıktan sonra, ilgili bloğun PQ imzalarını (`QcBlob`) ağdan talep edebilir.
- **Depolama:** Bu bloblar diskte ayrı bir tabloda tutulur ve isteğe bağlı olarak budanabilir (pruned).

---

## 3. PQ Fraud Proof (Sahtecilik Kanıtı)

Eğer bir validatör, geçersiz bir PQ imzası içeren bir `QcBlob` yayınlarsa, diğer düğümler bunu tespit edebilir.

1. **Kanıt Oluşturma:** Şikayetçi düğüm, hatalı PQ imzasını ve o imzanın `QcBlob` içindeki Merkle yolunu (Path) hazırlar.
2. **Bildirim:** `PqFraudProof` mesajı ağa yayılır.
3. **Cezalandırma:** Blok zinciri motoru bu kanıtı görürse, hileli `QcBlob` üreten validatörü slashing ile cezalandırır.

```rust
pub struct PqFraudProof {
    pub checkpoint_height: u64,
    pub invalid_signature_entry: PqSignatureEntry,
    pub merkle_proof: Vec<String>,
    pub reporter: String,
}
```

---

## 4. Mekanizmanın Avantajları

1. **Performans:** Normal çalışma süresince kuantum sonrası ağır matematiksel işlemler ana zinciri yormaz.
2. **Hafif Bloklar:** MB'larca tutan PQ imzaları blok başlığını şişirmez.
3. **Gelecek Güvencesi:** Kuantum bilgisayarlar aktifleştiğinde, Budlum "Optimistic" moddan "Strict" (Katı) moda geçerek her imzayı zorunlu olarak doğrulayabilir.

---

## Özet

Optimistic QC, Budlum'un **Mainnet Hardening** stratejisinin "uzun vadeli güvenlik" ayağını temsil eder:
- **Dilithium:** Modern PQ standardı.
- **Merkle Trees:** Devasa imzaların düzenli yönetimi.
- **Fraud Proofs:** Kötü niyetli aktörleri oyun dışı bırakan adalet mekanizması.
